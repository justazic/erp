{% extends "base.html" %}

{% block title %}Vazifalar{% endblock %}

{% block content %}
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        .task-card {
            background: #fff;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            border-left: 5px solid #4361ee; /* Default rang */
            transition: transform 0.2s;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .task-card:hover {
            transform: scale(1.01);
        }

        .deadline-urgent {
            border-left-color: #e74c3c; /* Qizil - muddati kam qolgan */
        }

        .task-info h5 {
            font-weight: 700;
            margin-bottom: 5px;
            color: #2b2d42;
        }

        .deadline-text {
            font-size: 0.85rem;
            color: #8d99ae;
        }

        .deadline-text i {
            margin-right: 5px;
        }

        .action-btn {
            padding: 8px 20px;
            border-radius: 10px;
            font-weight: 600;
            text-decoration: none;
            transition: 0.3s;
            display: inline-block;
        }

        .btn-submit {
            background: rgba(67, 97, 238, 0.1);
            color: #4361ee;
        }

        .btn-submit:hover {
            background: #4361ee;
            color: #fff;
        }

        .btn-check {
            background: rgba(46, 204, 113, 0.1);
            color: #2ecc71;
        }

        .btn-check:hover {
            background: #2ecc71;
            color: #fff;
        }

        .add-task-btn {
            background: #4361ee;
            color: white;
            padding: 10px 25px;
            border-radius: 12px;
            text-decoration: none;
            font-weight: 600;
            box-shadow: 0 4px 10px rgba(67, 97, 238, 0.3);
        }
    </style>

    <div class="container py-4">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <div>
                <h2 class="fw-bold mb-0">ðŸ“š O'quv vazifalari</h2>
                <p class="text-muted small">Barcha fanlar bo'yicha berilgan topshiriqlar</p>
            </div>

            {% if request.user.role == 'teacher' %}
                <a href="/tasks/assignments/create/" class="add-task-btn">
                    <i class="fas fa-plus me-2"></i> Vazifa qoâ€˜shish
                </a>
            {% endif %}
        </div>

        <div class="row">
            <div class="col-12">
                {% for a in assignments %}
                    <div class="task-card">
                        <div class="task-info">
                            <h5>{{ a.title }}</h5>
                            <div class="deadline-text">
                                <i class="far fa-calendar-alt"></i>
                                Muddat: <strong>{{ a.deadline|date:"d.m.Y" }}</strong>
                                <i class="far fa-clock ms-2"></i>
                                {{ a.deadline|date:"H:i" }}
                            </div>
                        </div>

                        <div class="task-actions">
                            {% if request.user.role == 'student' %}
                                <a href="/tasks/assignment/{{ a.id }}/submit/" class="action-btn btn-submit">
                                    <i class="fas fa-paper-plane me-1"></i> Yuborish
                                </a>
                            {% endif %}

                            {% if request.user.role == 'teacher' %}
                                <a href="/tasks/assignment/{{ a.id }}/submissions/" class="action-btn btn-check">
                                    <i class="fas fa-tasks me-1"></i> Tekshirish
                                </a>
                            {% endif %}
                        </div>
                    </div>
                {% empty %}
                    <div class="text-center py-5">
                        <img src="https://illustrations.popsy.co/flat/empty-box.svg"
                             style="width: 150px; opacity: 0.6;">
                        <h5 class="mt-3 text-muted">Hozircha vazifalar yo'q</h5>
                    </div>
                {% endfor %}
            </div>
        </div>
    </div>
{% endblock %}